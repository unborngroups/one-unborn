ALTER TABLE account_groups
ADD parent_id BIGINT UNSIGNED NULL AFTER id,
ADD status ENUM('draft','pending_checker','approved','rejected','locked')
    DEFAULT 'draft' AFTER type,
ADD is_locked TINYINT(1) DEFAULT 0 AFTER status,
ADD maker_id BIGINT UNSIGNED NULL,
ADD checker_id BIGINT UNSIGNED NULL,
ADD approved_at TIMESTAMP NULL;



-- 
-- 
SELECT f.*
FROM feasibilities f
JOIN feasibility_statuses fs ON fs.feasibility_id = f.id
WHERE fs.status = 'Closed'
AND f.id NOT IN (SELECT feasibility_id FROM purchase_orders);


SELECT f.id, f.feasibility_request_id, f.address
FROM feasibilities f
JOIN feasibility_statuses fs ON fs.feasibility_id = f.id
WHERE fs.status = 'Closed'
AND f.id NOT IN (SELECT feasibility_id FROM purchase_orders);
-- /
-- /

ALTER TABLE purchase_orders
ADD COLUMN `feasibility_request_id` VARCHAR(255) NULL AFTER 'feasibility_id';

ALTER TABLE deliverables
CHANGE payment_account_or_username_1 payment_account_1 TEXT NULL,
ADD COLUMN payment_username_1 TEXT NULL AFTER payment_account_1;

ALTER TABLE deliverables
CHANGE payment_account_or_username_2 payment_account_2 TEXT NULL,
ADD COLUMN payment_username_2 TEXT NULL AFTER payment_account_2;

ALTER TABLE deliverables
CHANGE payment_account_or_username_3 payment_account_3 TEXT NULL,
ADD COLUMN payment_username_3 TEXT NULL AFTER payment_account_3;

ALTER TABLE deliverables
CHANGE payment_account_or_username_4 payment_account_4 TEXT NULL,
ADD COLUMN payment_username_4 TEXT NULL AFTER payment_account_4;

ALTER TABLE deliverable_plans
CHANGE payment_account_or_username payment_account TEXT NULL,
ADD COLUMN payment_username TEXT NULL AFTER payment_account;


ALTER TABLE email_templates
ADD event_key VARCHAR(255) NULL AFTER company_id;

ALTER TABLE purchase_orders
ADD COLUMN `feasibility_request_id` VARCHAR(255) NULL AFTER 'feasibility_id';

ALTER TABLE renewals
ADD COLUMN `circuit_id` VARCHAR(255) NULL AFTER `deliverable_id`;

images/purchaseorder/PO%20ASPTN-121%20%281%29.pdf
images/purchaseorder/UNBORN%2011%20%282%29.pdf

ALTER TABLE renewals ADD COLUMN status VARCHAR(20) DEFAULT 'Active' AFTER alert_date;

ALTER TABLE clients
ADD COLUMN billing_sequence VARCHAR(225) NULL AFTER billing_spoc_email;

ALTER TABLE terminations
DROP COLUMN date_of_delivered;

ALTER TABLE terminations MODIFY circuit_id VARCHAR(225);

UPDATE terminations
SET status = 
    CASE
        WHEN termination_date IS NOT NULL THEN 'Terminated'
        WHEN termination_request_date IS NOT NULL THEN 'Pending'
        ELSE NULL
    END;


ALTER TABLE feasibilities
ADD COLUMN circuit_id VARCHAR(255) NULL AFTER delivery_company_name;



CREATE TABLE `private_messages` (
  `id` BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  `sender_id` BIGINT UNSIGNED NOT NULL,
  `receiver_id` BIGINT UNSIGNED NOT NULL,
  `message` TEXT NULL,
  `file_path` VARCHAR(255) NULL,
  `file_type` VARCHAR(100) NULL,
  `original_name` VARCHAR(255) NULL,
  `is_read` TINYINT(1) DEFAULT 0,
  `created_at` TIMESTAMP NULL DEFAULT NULL,
  `updated_at` TIMESTAMP NULL DEFAULT NULL,
  FOREIGN KEY (`sender_id`) REFERENCES `users`(`id`) ON DELETE CASCADE,
  FOREIGN KEY (`receiver_id`) REFERENCES `users`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

ALTER TABLE private_messages
ADD COLUMN `file_path` VARCHAR(255) NULL AFTER `message`,  
ADD COLUMN `file_type` VARCHAR(100) NULL AFTER `file_path`,  
ADD COLUMN `original_name` VARCHAR(255) NULL AFTER `file_type`;     